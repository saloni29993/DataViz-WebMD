<!DOCTYPE html>
<html>

<meta charset="utf-8">
<style>

/*  Human css */
.main{
    position:absolute;
    top:0px;
    left:0px;
    width: 100%;
    height: 100%;
    z-index: 1000;
}

#m1 {
    height: 20%;
}
#m2 {
    height: 24%;
}
#m3 {
    height: 18%;
}
#m4 {
    height: 38%;
}
#f1 {
    height: 23%;
}
#f2 {
    height: 23%;
}
#f3 {
    height: 16%;
}
#f4 {
    height: 38%;
}

text {
      font-size: 14px;
    }

path.chord {
  fill-opacity: .80;
}

.node {
  cursor: pointer;
}

.node:hover {
  stroke: #000;
  stroke-width: 1.5px;
}

.node--leaf {
  fill: white;
}

.label {
  font: 13px "Helvetica Neue", Helvetica, Arial, sans-serif;
  text-anchor: middle;
  text-shadow: 0 1px 0 #fff, 1px 0 0 #fff, -1px 0 0 #fff, 0 -1px 0 #fff;
}

.label,
.node--root,
.node--leaf {
  pointer-events: auto;
}

.space {
  display: inline-block;
  vertical-align: text-top; 
}

.holder {
  width: 300px;
  height: 300px;
  position: relative;
}

.men {
  position: absolute;
  z-index: 1;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.women {
  position: absolute;
  z-index: 1;
  top: 0;
  right: 0;
  width: 100%;
  height: 100%;
}

</style>

<body>
  <div class="space">
    <svg id="bubble" width="400" height="400"></svg>
  </div>



<div class="space" id="body">
  <div id="footer">

    <div class="hint"></div>
  </div>
</div>

<div class="space holder">
  <div class="main">
      <img src="humans1.png" height="100%" width="100%">
  </div>
  <div class="men">
      <div id="m1">
      </div>
      <div id="m2">
      </div>
      <div id="m3">
      </div>
      <div id="m4">    
      </div>
  </div>
  <div class="women">
      <div id="f1">
      </div>
      <div id="f2">
      </div>
      <div id="f3">
      </div>
      <div id="f4">    
      </div>      
  </div>
  
</div>




<script src="https://d3js.org/d3.v4.min.js"></script>
<!-- Bubble Chart -->
<script>
var d3v4 = d3;
//console.log("for bubble" +JSON.stringify(d3v4));
var svg = d3v4.select("#bubble"),
    margin = 20,
    diameter = +svg.attr("width"),
    g = svg.append("g").attr("transform", "translate(" + diameter / 2 + "," + diameter / 2 + ")");

var color = d3v4.scaleLinear()
    .domain([-1, 5])
    .range(["hsl(152,80%,80%)", "hsl(228,30%,40%)"])
    .interpolate(d3v4.interpolateHcl);

var pack = d3v4.pack()
    .size([diameter - margin, diameter - margin])
    .padding(2);

d3v4.json("bubble.json", function(error, root) {
  if (error) throw error;

  root = d3v4.hierarchy(root)
      .sum(function(d) { return d.size; })
      .sort(function(a, b) { return b.value - a.value; });

  var focus = root,
      nodes = pack(root).descendants(),
      view;

  //console.log("FOcus : " + JSON.stringify(focus));

  var circle = g.selectAll("circle")
    .data(nodes)
    .enter().append("circle")
      .attr("class", function(d) { return d.parent ? d.children ? "node" : "node node--leaf" : "node node--root"; })
      .style("fill", function(d) { return d.children ? color(d.depth) : null; })
      .on("click", function(d) { 
        if (d3.select(this).classed("node--leaf")) {
          //alert(d.data.name); //open URL here
          topic_name = d.data.name.toLowerCase() + "-questions";
          //Heart of interaction with other charts
          updateChord(topic_name);
          updateHuman(topic_name);

        } else {
          if (focus !== d) zoom(d); d3.event.stopPropagation(); 
        }
      });

  var text = g.selectAll("text")
    .data(nodes)
    .enter().append("text")
      .attr("class", "label")
      .style("fill-opacity", function(d) { return d.parent === root ? 1 : 0; })
      .style("display", function(d) { return d.parent === root ? "inline" : "none"; })
      .text(function(d) { return d.data.name; });

  var node = g.selectAll("circle,text");

  svg
      .style("background", "white")
      .on("click", function() { zoom(root); });

  zoomTo([root.x, root.y, root.r * 2 + margin]);

  function zoom(d) {
    var focus0 = focus; focus = d;

    var transition = d3v4.transition()
        .duration(d3v4.event.altKey ? 7500 : 750)
        .tween("zoom", function(d) {
          var i = d3v4.interpolateZoom(view, [focus.x, focus.y, focus.r * 2 + margin]);
          return function(t) { zoomTo(i(t)); };
        });

    transition.selectAll("text")
      .filter(function(d) { return d.parent === focus || this.style.display === "inline"; })
        .style("fill-opacity", function(d) { return d.parent === focus ? 1 : 0; })
        .on("start", function(d) { if (d.parent === focus) this.style.display = "inline"; })
        .on("end", function(d) { if (d.parent !== focus) this.style.display = "none"; });
  }

  function zoomTo(v) {
    var k = diameter / v[2]; view = v;
    node.attr("transform", function(d) { return "translate(" + (d.x - v[0]) * k + "," + (d.y - v[1]) * k + ")"; });
    circle.attr("r", function(d) { return d.r * k; });
  }
});

</script>

<!-- ####################################################################################################### -->


<script src="https://d3js.org/d3.v3.min.js"></script>


<!-- Chord Chart -->
<script type="text/javascript">
var d3v3 = d3;
//console.log("for chord" +JSON.stringify(d3v3));
//window.topicQuestionInput = "pregnancy-questions";

var w = 600,
    h = 500,
    r1 = (h-110) / 2,
    r0 = r1 - 80;

var fill = d3v3.scale.category20c(); //d3v3.scaleOrdinal(d3v3.schemeCategory20c);

var chord = d3v3.layout.chord()
    .padding(.04)
    .sortSubgroups(d3v3.descending)
    .sortChords(d3v3.descending);

var arc = d3v3.svg.arc()
    .innerRadius(r0)
    .outerRadius(r0 + 20);

var svg = d3v3.select("#body").append("svg:svg")
    .attr("class","temp_class")
    .attr("width", w)
    .attr("height", h)
    .append("svg:g")
    .attr("transform", "translate(" + (w) / 2 + "," + (h) / 2 + ")");

function updateChord(param) {

    d3v3.select("#body svg").remove();

    var svg = d3v3.select("#body").append("svg:svg")
        .attr("width", w)
        .attr("height", h)
        .append("svg:g")
        .attr("transform", "translate(" + (w) / 2 + "," + (h) / 2 + ")");

    d3v3.json("chord_topics.json", function(imports) {
      var indexByName = {},
          nameByIndex = {},
          matrix = [],
          n = 0;

    //Adding logic for detecting the topic
      var disease_list = [];
      imports.forEach(function(d) {
        if (d.topic == param) //window.topicQuestionInput)
          disease_list = d.disease_list;
      });


      //console.log(imports);
      self.names = [];

      // Returns the Flare package name for the given class name.
      function name(name) {
        return name;
      }

      // Compute a unique index for each package name.
      disease_list.forEach(function(d) {
        d = name(d.name);
        //console.log(d);
        if (!(d in indexByName)) {
          nameByIndex[n] = d;
          indexByName[d] = n++;
          names.push(d);
        }
      });

      // Construct a square matrix counting package imports.
      disease_list.forEach(function(d) {
        var source = indexByName[name(d.name)],
            row = matrix[source];
        if (!row) {
         row = matrix[source] = [];
         for (var i = -1; ++i < n;) row[i] = 0;
        }
        d.imports.forEach(function(d) { row[indexByName[name(d)]]++; });
      });

      chord.matrix(matrix);

      var g = svg.selectAll("g.group")
          .data(chord.groups)
        .enter().append("svg:g")
          .attr("class", "group")
          .on("mouseover", fade(.02))
          .on("mouseout", fade(.80));

      g.append("svg:path")
          .style("stroke", function(d) { return fill(d.index); })
          .style("fill", function(d) { return fill(d.index); })
          .attr("d", arc);

      g.append("svg:text")
          .each(function(d) { d.angle = (d.startAngle + d.endAngle) / 2; })
          .attr("dy", ".35em")
          .attr("text-anchor", function(d) { return d.angle > Math.PI ? "end" : null; })
          .attr("transform", function(d) {
            return "rotate(" + (d.angle * 180 / Math.PI - 90) + ")"
                + "translate(" + (r0 + 26) + ")"
                + (d.angle > Math.PI ? "rotate(180)" : "");
          })
          .text(function(d) { return nameByIndex[d.index]; });

      svg.selectAll("path.chord")
          .data(chord.chords)
          .enter().append("svg:path")
          .attr("class", "chord")
          .style("stroke", function(d) { return d3v3.rgb(fill(d.source.index)).darker(); })
          .style("fill", function(d) { return fill(d.source.index); })
          .attr("d", d3v3.svg.chord().radius(r0));

    });


    // Returns an event handler for fading a given chord group.
    function fade(opacity) {
      //console.log("oyoyoy" +opacity);
      return function(d, i) {
        svg.selectAll("path.chord")
            .filter(function(d) { return d.source.index != i && d.target.index != i; })
            .style("stroke-opacity", opacity)
            .style("fill-opacity", opacity);
      };
    }

}



</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

<script type="text/javascript">

    var human_data = {
        "pain-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",
        
        "uterus-questions" : "f3",

        "pregnancy-questions" : "f3",

        "period-questions" : "f1,f2,f3,f4",

        "vagina-questions" : "f3",

        "breast-questions" : "f2",

        "birth-control-questions" : "f2,f3,f4", 

        "ovulation-questions" : "f3",

        "nipple-questions" : "m2,f2",

        "feeding-questions" : "f2",

        "breast-cancer-questions" : "f2",

        "clitoris-questions" : "f3",

        "vaginal-discharge-questions" : "f3",

        "hemorrhoid-questions" : "m3,f3",

        "menstrual-questions" : "f3",

        "menopause-questions" : "f3",

        "miscarriage-questions" : "f3",

        "tampon-questions" : "f3",

        "ovary-questions" : "f3",

        "cervix-questions" : "f3",

        "hysterectomy-questions" : "f3",

        "birth-questions": "f1,f2,f3,f4",

        "prostate-questions" : "m3", 

        "vasectomy-questions" : "m3",

        "penis-questions" : "m3",

        "chest-questions" : "m2",

        "testicle-questions" : "m3",

        "erection-questions" : "m3",

        "masturbation-questions" : "m3,f3",

        "sperm-questions" : "m3",

        "scrotum-questions" : "m3",

        "foreskin-questions" : "m3",

        "erectile-dysfunction-questions" : "m3",

        "testosterone-questions" : "m3",

        "drug-test-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "marijuana-questions" : "m1,f1",

        "Drinking-questions" : "m1,f1,m3,f3",

        "Drugs-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "Smoking-questions" : "m1,f1",

        "alcoholism-questions" : "m1,f1,m3,f3", 

        "steroid-questions" : "m2,f2",

        "insulin-questions" : "m3,f3",

        "antibiotic-questions" : "m1,f1",

        "supplement-questions" : "m1,f1",

        "salt-questions" : "m1,f1,m3,f3",

        "food-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "milk-questions" : "m1,f1,m2,f2,m3,f3",

        "soda-questions" : "m2,f2,m3,f3",

        "coffee-questions" : "m2,f2,m3,f3",

        "meat-questions" : "m2,f2",

        "tea-questions" : "m1,f1,m2,f2",

        "caffeine-questions" : "m1,f1,m2,f2",

        "chlamydia-questions" : "m3,f3",

        "sexually-transmitted-disease-questions" : "m1,f1,m3,f3",

        "Sexually-Intercourse-questions" : "m1,f1,m3,f3",

        "herpes-questions" : "m1,f1,m3,f3",

        "hiv-questions" : "m3,f3",

        "orgasm-questions" : "f3",

        "genitalia-questions" : "m3,f3",

        "genital-herpes-questions" : "m3,f3",

        "fertility-questions" : "m3,f3",

        "libido-questions" : "m3,f3",

        "anus-questions" : "m3,f3",

        "vision-questions" : "m1,f1",

        "eyes-questions" : "m1,f1",

        "pink-eye-questions" : "m1,f1",

        "eyelid-questions" : "m1,f1",

        "tinnitus-questions" : "m1,f1",

        "ear-infection-questions" : "m1,f1",

        "ears-questions" : "m1,f1",

        "lip-questions" : "m1,f1",

        "mouth-questions" : "m1,f1",

        "tooth-questions" : "m1,f1",

        "tongue-questions" : "m1,f1",

        "jaw-questions" : "m1,f1",

        "stroke-questions" : "m2,f2",

        "heart-questions" : "m2,f2",

        "blood-clot-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "pulse-questions" : "m2,f2",

        "artery-questions" : "m2,f2",

        "heart-attack-questions" : "m2,f2",

        "heart-disease-questions" : "m2,f2",

        "cholesterol-questions" : "m2,f2",

        "heartburn-questions" : "m2,f2", 

        "flatulence-questions" : "m3,f3",

        "pelvis-questions" : "m3,f3",

        "appendix-questions" : "m2,f2",

        "pelvic-area-questions" : "m3,f3",

        "lymph-node-questions" : "m3,f3",

        "intestine-questions" : "m3,f3",

        "colonoscopy-questions" : "m3,f3",

        "bladder-questions" : "m3,f3",

        "rectum-questions" : "m3,f3",

        "abdominal-pain-questions" : "m3,f3",

        "constipation-questions" : "m2,f2",

        "bloating-questions" : "m2,f2",

        "waist-questions" : "m3,f3",

        "kidney-questions" : "m3,f3",

        "kidney-stone-questions" : "m3,f3",

        "urinary-tract-infection-questions" : "m3,f3",

        "hernia-questions" : "m2,f2",

        "stomach-questions" : "m2,f2",

        "diarrhea-questions" : "m2,f2",

        "belly-button-questions" : "m2,f2",

        "bowel-movement-questions" : "m3,f3",

        "movement-questions" : "m2,m3,f2,f3",

        "finger-questions" : "m3,f3,m4,f4",

        "rheumatoid-arthritis-questions" : "m3,f3,m4,f4",

        "calf-questions" : "m4,f4",

        "elbow-questions" : "m3,f3",

        "arthritis-questions" : "m4,f4",

        "hand-questions" : "m2,m3,f2,f3",

        "fracture-questions" : "m2,m3,m4,f2,f3,f4",

        "knee-questions" : "m4,f4",

        "big-toe-questions" : "m4,f4",

        "thumb-questions" : "m3,f3,m4,f4",

        "nail-questions" : "m3,f3,m4,f4",

        "forearm-questions" : "m3,f3",

        "toe-questions" : "m4,f4",

        "ankle-questions" : "m4,f4",

        "armpit-questions" : "m2,f2",

        "foot-questions" : "m4,f4",

        "wrist-questions" : "m3,f3",

        "shoulder-questions" : "m2,f2",

        "thigh-questions" : "m4,f4",

        "leg-questions" : "m4,f4",

        "prostate-cancer-questions" : "m3",

        "cancer-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "breast-cancer-questions" : "f2",

        "chemotherapy-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "magnetic-resonance-imaging-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "tumor-questions" : "m1,f1",

        "muscle-questions" : "m2,m3,m4,f2,f3,f4",

        "fatigue-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "tightness-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "Pain-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "back-pain-questions" : "m2,m3,f2,f3",

        "blister-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "cyst-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "human-papillomavirus-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "yeast-infection-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "wrinkle-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "boil-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "mole-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "wart-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "hair-loss-questions" : "m1,f1",

        "skin-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "itch-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "rash-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "lump-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "shingles-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "inflammation-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "chickenpox-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "psoriasis-questions" : "m1,f1",

        "scar-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "wound-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "dry-skin-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "hair-questions" : "m1,f1",

        "bruise-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "acne-questions" : "m1,f1",

        "scalp-questions" : "m1,f1",

        "flu-questions" : "m1,f1",

        "cough-questions" : "m1,f1",

        "sinus-questions" : "m1,f1",

        "tonsil-questions" : "m1,f1",

        "sore-throat-questions" : "m1,f1",

        "lung-questions" : "m2,f2",

        "asthma-questions" : "m1,f1,m2,f2",

        "pneumonia-questions" : "m2,f2",

        "throat-questions" : "m1,f1",

        "bronchitis-questions" : "m1,m2,f1,f2",

        "sinus-infection-questions" : "m1,f1",

        "strep-throat-questions" : "m1,f1",

        "smell-questions" : "m1,f1",

        "vertigo-questions" : "m1,f1",

        "neck-questions" : "m1,f1",

        "spine-questions" : "m2,f2",

        "trauma-questions" : "m1,f1",

        "bipolar-disorder-questions" : "m1,f1",

        "seizure-questions" : "m1,f1",

        "brain-questions" : "m1,f1",

        "weight-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "diet-questions" : "m2,f2",

        "obesity-questions" : "m2,f2,m3,f3",

        "weight-gain-questions" : "m2,m3,m4,f2,f3,f4",

        "workout-questions" : "m2,m3,m4,f2,f3,f4",

        "weight-loss-questions" : "m2,m3,m4,f2,f3,f4",

        "hunger-questions" : "m2,f2",

        "thyroid-questions" : "m2,f3,m2,f3",

        "exercise-questions" : "m2,m3,m4,f2,f3,f4",

        "weakness-questions" : "m2,m3,m4,f2,f3,f4",

        "drowsiness-questions" : "m1,f1",

        "allergy-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "Swelling-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "fever-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "Coldness-questions" : "m1,f1",

        "headache-questions" : "m1,f1",

        "burn-questions" : "m2,f2",

        "spotting-questions" : "m1,m2,m3,m4,f1,f2,f3,f4",

        "cramps-questions" : "m2,m4,f2,f4",

        "urination-questions" : "m3,f3",

        "dizziness-questions" : "m1,f1",

        "anxiety-questions" : "m1,f1",

        "vomit-questions" : "m1,m2,f1,f2",

        "surgery-questions" : "m1,m2,m3,m4,f1,f2,f3,f4"
    };


function updateHuman(item) {
  console.log(item);

  ["m1","m2","m3","m4","f1","f2","f3","f4"].forEach( function(d) {
    $('#'+d).css("background","none");
  });

  var divs = human_data[item];

  var highlight = divs.split(",");

  highlight.forEach(function(d) {
      $('#'+d).css("background-color","red");
  });



}

    
</script>

</body>
</html>